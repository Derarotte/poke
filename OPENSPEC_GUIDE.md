# OpenSpec 变更提案指南

## 📚 快速导航

### 现有提案

| 提案 | 文件 | 规模 | 优先级 |
|------|------|------|--------|
| 1️⃣ **核心游戏** | `20251021-pokemon-core.md` | 小 | ✅ 已完成 |
| 2️⃣ **复活系统** | `20251021-pokemon-revival-system.md` | 中 | ⭐⭐⭐ |
| 3️⃣ **地图与NPC** | `20251021-map-and-npc-battle-system.md` | 大 | ⭐⭐⭐ |

---

## 🎯 提案详解

### 提案 1: 核心游戏 ✅ (已实现)

**现状**: 完整的宝可梦游戏基础
- ✅ 16 种宝可梦
- ✅ 40+ 种招式
- ✅ 18 种属性和克制系统
- ✅ 回合制战斗
- ✅ 捕捉和队伍管理

**位置**: `openspec/changes/20251021-pokemon-core.md`

---

### 提案 2: 宝可梦复活系统 ⭐⭐⭐

**概述**: 从单局游戏升级为持续冒险

**关键特性**:
```
❌ 旧: 队伍全灭 → 游戏结束
✅ 新: 队伍全灭 → 三种复活选择 → 继续游戏
```

**三种复活方式**:
1. **使用恢复药** - 消耗背包中的恢复道具
2. **精灵中心** - 支付 200 金币复活全队
3. **队伍切换** - 如果有未昏迷的宝可梦继续战斗

**新增系统**:
- 金币经济系统
- 精灵中心 NPC
- 复活菜单

**实施复杂度**: ⭐⭐ 中等

**位置**: `openspec/changes/20251021-pokemon-revival-system.md`

**建议先实施这个提案** (3-4 小时) 为提案 3 打好基础

---

### 提案 3: 地图与 NPC 对战系统 ⭐⭐⭐⭐⭐

**概述**: 完整的 RPG 体验升级

**核心模块**:

#### 1️⃣ **地图系统**
- 8+ 个地点
- 多个区域
- 地点之间导航

#### 2️⃣ **NPC 系统**
- 10+ 个预设对手
- 可提前查看对方队伍 (战术性)
- 击败后获得奖励

#### 3️⃣ **宝可梦生成系统** (最核心)

**个体值 (IV) 系统**:
```
范围: 0-31 (每个属性)
效果: 影响宝可梦属性的 12.5%
收集: 玩家通过对战发现高 IV 宝可梦

例: 皮卡丘
- 低 IV: 速度 = 90 (基础 90, IV 0)
- 高 IV: 速度 = 121 (基础 90, IV 31)
```

**天赋系统**:
```
数量: 18+ 种天赋
作用: 提供独特能力

例: 威吓
- 进场时自动降低对手宝可梦的攻击
- 战术相关性强
```

**性格系统**:
```
数量: 25 种性格
作用: 影响属性增长

例: Adamant (倔强)
- 攻击 +10%, 特攻 -10%
```

**唯一性保证**:
```
每只宝可梦是独一无二的
- 不会生成重复的宝可梦
- 使用哈希函数防重复
- 收集目标: "最优宝可梦"
```

**实施复杂度**: ⭐⭐⭐⭐ 大型

**位置**: 
- 主提案: `openspec/changes/20251021-map-and-npc-battle-system.md`
- 任务分解: `openspec/changes/20251021-map-and-npc-battle-system-tasks.md`

---

## 📊 三个提案的关系

```
提案1: 基础游戏框架
  ↓ (必要条件)
提案2: 复活系统 (开放式设计)
  ↓ (建立在之上)
提案3: 地图与NPC (完整RPG体验)
```

**实施建议**:
1. 提案 1 已完成 ✅
2. 提案 2 需要实施 (短期, 3-4小时)
3. 提案 3 在提案 2 完成后实施 (长期, 20-24小时)

---

## 🚀 如何查看提案

### 查看完整设计
```bash
# 提案 2
cat openspec/changes/20251021-pokemon-revival-system.md

# 提案 3 - 设计文档
cat openspec/changes/20251021-map-and-npc-battle-system.md

# 提案 3 - 任务分解
cat openspec/changes/20251021-map-and-npc-battle-system-tasks.md
```

### 查看总结
```bash
cat PROPOSAL_SUMMARY.md
```

---

## 📋 提案内容快速索引

### 提案 2: 复活系统

**关键章节**:
- 设计 → 系统架构
- 数据结构 → Player 结构增强
- 实现步骤 → 6 个阶段
- CLI 菜单示例 → 3 个菜单

**文件**: `openspec/changes/20251021-pokemon-revival-system.md`

### 提案 3: 地图与 NPC

**关键章节**:
- 设计 → 系统架构 (8 个模块)
- 数据结构 → Location, NPC, PokemonInstance 等
- 宝可梦生成系统详解 → IV, 天赋, 性格, 唯一性
- 实现步骤 → 8 个阶段
- CLI 菜单示例 → 3 个示例菜单

**文件**: `openspec/changes/20251021-map-and-npc-battle-system.md`

**任务分解** (详细):
- 8 个阶段，总共 48 个具体任务
- 每个任务包含文件、内容、验证方法
- 时间估计和依赖关系图

**文件**: `openspec/changes/20251021-map-and-npc-battle-system-tasks.md`

---

## 💡 提案亮点

### 提案 2 的创新
- **开放式设计**: 不再有"游戏结束"的硬墙
- **策略性**: 玩家需要管理资源和复活时机
- **经济循环**: 金币变得有实际意义

### 提案 3 的创新
- **IV 系统**: 使同一物种的宝可梦多样化 (最大攻击差异 30%)
- **天赋系统**: 战术深度大幅增加
- **性格系统**: 25 种选择提供丰富的个性化
- **唯一性**: 每只宝可梦都是独特的收集目标

---

## ✅ 实施建议

### 优先级
```
🔴 高优先级: 提案 2 (3-4 小时)
   - 显著提升可玩性
   - 为提案 3 打基础
   - 风险低，收益高

🟠 中优先级: 提案 3 第 1-5 阶段 (15 小时)
   - 数据结构和宝可梦生成系统
   - 地图和对战集成
   - 核心功能

🟡 低优先级: 提案 3 第 6-8 阶段 (5-9 小时)
   - 高级功能和 UI 优化
   - 测试和文档
   - 收尾工作
```

### 时间规划
```
第一周: 实施提案 2
  ├─ 第 1 天: 理解设计
  ├─ 第 2 天: 数据结构
  ├─ 第 3 天: 菜单实现
  ├─ 第 4 天: 集成和测试
  └─ 第 5 天: 文档和打磨

第二周: 开始提案 3
  ├─ 第 1-2 天: 理解设计和任务规划
  ├─ 第 3-5 天: 宝可梦生成系统 (最重要)
  └─ ...继续...

第三周: 继续提案 3
  ├─ 第 1-4 天: 地图和 NPC 系统
  ├─ 第 5 天: 对战集成
  └─ ...继续...

第四周: 完成提案 3
  ├─ 第 1-3 天: 高级功能
  ├─ 第 4 天: 测试
  └─ 第 5 天: 文档和发布
```

---

## 📈 预期效果

### 实施提案 2 后
```
游戏长度:     30 分钟 → 1 小时
可玩性:       低 → 中
策略深度:     低 → 中
主要改进:     允许玩家持续游戏
```

### 实施提案 3 后
```
游戏长度:     1 小时 → 5+ 小时
内容量:       1 个地点 → 8+ 个地点
对手数:       0 → 10+
宝可梦多样性: 低 → 高
策略深度:     中 → 深
重玩价值:     低 → 高
```

---

## 🔗 相关文件

### 项目文档
- `README.md` - 项目总体介绍
- `GAMEPLAY.md` - 游戏指南
- `PROJECT_SUMMARY.md` - 项目完成总结
- `PROPOSAL_SUMMARY.md` - 提案快速总结

### OpenSpec 文件
- `openspec/project.md` - 项目规范
- `openspec/AGENTS.md` - 开发工作流
- `openspec/changes/` - 所有提案

---

## ❓ 常见问题

### Q: 应该从哪个提案开始?
A: 提案 1 已完成。建议接下来实施提案 2 (3-4小时)，然后再做提案 3。

### Q: 提案 2 和提案 3 可以同时进行吗?
A: 不建议。提案 2 为提案 3 打基础，先完成提案 2 会更顺利。

### Q: 提案 3 太大了，可以分成几部分?
A: 可以。推荐按 8 个阶段分次实施，重点是前 5 个阶段。

### Q: 宝可梦生成系统有多复杂?
A: 中等复杂。核心是:
- IV 生成 (简单)
- 天赋选择 (简单)
- 性格应用 (简单)
- 唯一性检查 (中等)
- 属性计算 (中等)

### Q: 需要改动现有代码吗?
A: 是的，但改动保守:
- 提案 2: 修改游戏循环、玩家系统
- 提案 3: 添加新模块、集成现有系统

### Q: 现有存档会失效吗?
A: 需要迁移，但不会完全失效。可以保留但更新数据结构。

---

## 📞 反馈和修改

如果你想:

1. **查看详细设计**
   ```
   查看相应的 .md 文件
   ```

2. **修改提案内容**
   ```
   编辑 openspec/changes/ 中的文件
   ```

3. **提出改进建议**
   ```
   - 调整金币费用
   - 修改 NPC 队伍
   - 改变实施顺序
   - 添加新功能
   ```

4. **开始实施**
   ```
   /openspec:apply <proposal-id>
   ```

---

## 🎓 学习资源

### Rust 概念
- 类型系统和结构体设计
- 哈希和唯一性
- 随机数和概率
- 大型系统集成

### 游戏设计
- 难度梯度
- 经济系统设计
- 收集系统设计
- 玩家体验优化

### 项目管理
- OpenSpec 工作流
- 任务分解
- 优先级规划
- 测试策略

---

**最后更新**: 2025-10-21  
**提案总数**: 3 个  
**总行数**: 1600+ 行文档

祝你实施愉快！🚀

