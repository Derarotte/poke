# 位置强绑定规范

## ADDED Requirements

### Requirement: 位置绑定
玩家在游戏中任何时刻都应该位于一个具体的地点。

#### Scenario: 游戏开始时玩家位置
```
Given: 玩家刚开始新游戏
When: 游戏初始化完成
Then: 玩家应该位于常青小镇 (ID: 101)
And: 游戏菜单应该显示当前位置信息
```

#### Scenario: 移动后位置更新
```
Given: 玩家位于常青小镇
And: 常青森林已解锁
When: 玩家选择移动到常青森林
Then: current_location_id 应该更新为 102
And: 游戏显示常青森林信息
```

#### Scenario: 位置持久化
```
Given: 玩家位于华蓝市 (ID: 105)
When: 玩家保存游戏
And: 重新加载游戏
Then: 玩家应该仍位于华蓝市
```

---

### Requirement: 地点连接性
地点之间应该有明确的地理连接关系，玩家只能移动到相邻的地点。

#### Scenario: 查看可达地点
```
Given: 玩家位于常青小镇
When: 玩家选择移动菜单
Then: 应该只显示可达的地点:
  - 常青森林 (相邻且已解锁)
And: 不应该显示:
  - 月见山 (虽然解锁但不相邻)
```

#### Scenario: 无法直达非相邻地点
```
Given: 玩家位于常青小镇
And: 华蓝市已解锁
When: 玩家尝试移动到华蓝市
Then: 系统应该拒绝
And: 显示 "无法到达该地点，请从相邻地点前往"
```

---

### Requirement: 访问状态追踪
系统应该记录玩家访问过的所有地点。

#### Scenario: 记录已访问地点
```
Given: 玩家访问了新地点
When: 玩家移动到该地点
Then: 该地点应该被标记为 "已访问"
And: 可以在地点列表中标记显示
```

#### Scenario: 已访问地点持久化
```
Given: 玩家访问过常青森林、华石镇、月见山
When: 玩家保存并重新加载游戏
Then: 所有三个地点应该仍为 "已访问" 状态
```

---

## MODIFIED Requirements

### Requirement: 游戏菜单更新
游戏主菜单应该显示当前位置信息和可用的移动选项。

#### Scenario: 主菜单显示位置
```
Given: 玩家位于常青小镇
When: 游戏显示主菜单
Then: 应该在菜单顶部显示:
  位置: 常青小镇 (草地)
  已访问: 1/11 个地点
```

#### Scenario: 移动菜单显示条件
```
Given: 玩家位于常青小镇
When: 玩家打开移动菜单
Then: 应该显示:
  ✓ 常青森林 (已解锁)
  🔒 华石镇 (需要等级5, 当前3)
  🔒 月见山 (需要等级7+徽章, 当前3级无徽章)
```

