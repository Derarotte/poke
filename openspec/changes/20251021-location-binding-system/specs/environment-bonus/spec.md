# 环境加成规范

## ADDED Requirements

### Requirement: 环境属性加成
每个地点应该根据其环境类型对宝可梦属性提供相应的加成。

#### Scenario: 草地速度加成
```
Given: 玩家位于常青森林 (环境: 草地)
And: 野生宝可梦皮卡丘基础速度为 100
When: 宝可梦在此地点遭遇
Then: 显示属性应该为:
  速度: 110 (基础 100 + 10%)
```

#### Scenario: 山地攻击加成
```
Given: 玩家位于月见山 (环境: 山地)
And: 野生宝可梦小拳石基础攻击为 80
When: 宝可梦在此地点遭遇
Then: 显示属性应该为:
  攻击: 88 (基础 80 + 10%)
```

#### Scenario: 城市全属性加成
```
Given: 玩家位于金黄市 (环境: 城市)
And: 野生宝可梦皮卡丘基础属性为:
  HP: 35, 攻击: 55, 防守: 40, 特攻: 50, 特防: 50, 速度: 90
When: 宝可梦在此地点遭遇
Then: 显示属性应该为:
  HP: 36, 攻击: 57, 防守: 42, 特攻: 52, 特防: 52, 速度: 94
  (所有属性 +5%)
```

---

### Requirement: 环境加成计算准确性
加成计算应该正确处理舍入，并在所有情况下一致。

#### Scenario: 浮点舍入
```
Given: 基础属性为 33，环境加成为 +10%
When: 计算加成后属性
Then: 结果应该为 36 (33 * 1.1 = 36.3 → 四舍五入为 36)
```

#### Scenario: 加成不改变战斗逻辑
```
Given: 玩家选择与野生宝可梦战斗
When: 战斗开始
Then: 加成应该只在预览中显示
And: 实际对战使用原始属性
And: 加成不应该影响捕捉或逃跑概率
```

---

### Requirement: 环境类型定义
系统应该明确定义所有可用的环境类型及其加成。

#### Scenario: 环境类型映射
```
Given: 环境加成系统已实现
When: 检查所有地点的环境类型
Then: 应该包含所有这些类型:
  - Grassland (草地): 速度 +10%
  - Forest (森林): 防守 +10%
  - Cave (洞穴): 特攻 +10%
  - Water (水域): 特防 +10%
  - Mountain (山地): 攻击 +10%
  - City (城市): 所有 +5%
```

---

## MODIFIED Requirements

### Requirement: 野生遭遇显示
野生宝可梦遭遇屏幕应该同时显示原始属性和加成后属性。

#### Scenario: 遭遇预览显示
```
Given: 玩家在草地地点触发遭遇
And: 野生宝可梦是皮卡丘 Lv5
When: 显示遭遇信息
Then: 应该显示:
  野生宝可梦出现!
  ┌──────────────────┐
  │ 名字: 皮卡丘      │
  │ 等级: 5          │
  │ 类型: 电系        │
  │ 当前环境: 草地    │
  │
  │ 属性加成 (+10%):  │
  │   速度: 100 → 110 │
  └──────────────────┘
```

